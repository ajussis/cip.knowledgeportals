<html metal:use-macro="here/main_template/macros/master">

<metal:block fill-slot="top_slot"
                 tal:define="disable_column_one python:request.set('disable_plone.leftcolumn',1);" />

    <metal:main_macro define-macro="main">
        <metal:main fill-slot="main" tal:define="kssClassesView context/@@kss_field_decorator_view;
                                                 getKssClasses nocall:kssClassesView/getKssClassesInlineEditable;
                                                 templateId template/getId;
                                                 toLocalizedTime nocall:context/@@plone/toLocalizedTime;">
            <h1 tal:content="context/Title" />
            <img src="userconfig.png" width="100" style="float:left;" />
            <p style="margin: 7px 20px; float:left; width:75%; " tal:content="context/Description"/>

            <div style="clear:both;"></div>


            <div style="margin:10px 0 0 20px; width:50%; float:left;" tal:define="users view/activemembers;
                                                                                  users2 view/activemembersByName;
                                                                                  membership context/portal_membership;">
                <div>
                    <h2 class="content-tab">Sort by content</h2>
                    <table style="width:100%;">
                        <div tal:repeat="user users">
                            <tr style="background:#f8f8f8; -moz-border-radius:0.4em; -webkit-border-radius:0.4em; border-bottom:solid white 2px; padding:1px;">
                                <tal:defineAgain define="userName python:user[0];
                                                         userObjects python:user[1];
                                                         info python:membership.getMemberInfo(userName);
                                                         fullname info/fullname;
                                                         location info/location;
                                                         member python:here.getMemberById(userName);
                                                         institution python:member.getProperty('institution');">
                                    <!--img src="#" tal:attributes="src userImage" width="30" style="margin:15px 11px; float:left;" /-->
                                    <td style="padding-right:8px;">
                                        <span style="font-weight:normal; font-style:italic;">
                                            <tal:contentThis content="userObjects"/>
                                        </span>
                                    </td>
                                    <td style="padding-right:8px;">
                                        <span style="font-weight:bold; color:#581A74;" tal:define="url python:'/'.join(here.getPhysicalPath()) + '/author/'+userName;">
                                            <a tal:condition="python:len(fullname) != 0" href="#" tal:attributes="href url"><tal:block replace="fullname"/></a>
                                            <a tal:condition="python:len(fullname) == 0" href="#" tal:attributes="href url"><tal:block replace="userName"/></a>
                                        </span>
                                    </td>
                                    <td style="width:70px; padding-right:8px;">
                                        <span style="font-weight:normal;" tal:define="url python:'/'.join(here.getPhysicalPath()) + '/author/'+userName;">
                                            <!--a tal:condition="python:len(institution) != 0" href="#" tal:attributes="href url"--><tal:block replace="institution"/><!--/a-->
                                        </span>
                                    </td>
                                </tal:defineAgain>
                            </tr>
                        </div>
                    </table>
                    <h2 class="content-tab">Sort by name</h2>
                    <table style="width:100%;">
                        <div tal:repeat="user users2">
                            <tr style="background:#f8f8f8; -moz-border-radius:0.4em; -webkit-border-radius:0.4em; border-bottom:solid white 2px; padding:1px;">
                                <tal:defineAgain define="userName python:user[0];
                                                         userObjects python:user[1];
                                                         info python:membership.getMemberInfo(userName);
                                                         fullname info/fullname;
                                                         location info/location;
                                                         member python:here.getMemberById(userName);
                                                         institution python:member.getProperty('institution');">
                                    <td style="padding-right:8px;">
                                        <span style="font-weight:normal; font-style:italic;">
                                            <tal:contentThis content="userObjects"/>
                                        </span>
                                    </td>
                                    <td style="padding-right:8px;">
                                        <span style="font-weight:bold; color:#581A74;" tal:define="url python:'/'.join(here.getPhysicalPath()) + '/author/'+userName;">
                                            <a tal:condition="python:len(fullname) != 0" href="#" tal:attributes="href url"><tal:block replace="fullname"/></a>
                                            <a tal:condition="python:len(fullname) == 0" href="#" tal:attributes="href url"><tal:block replace="userName"/></a>
                                        </span>
                                    </td>
                                    <td style="width:70px; padding-right:8px;">
                                        <span style="font-weight:normal;" tal:define="url python:'/'.join(here.getPhysicalPath()) + '/author/'+userName;">
                                            <!--a tal:condition="python:len(institution) != 0" href="#" tal:attributes="href url"--><tal:block replace="institution"/><!--/a-->
                                        </span>
                                    </td>
                                </tal:defineAgain>
                            </tr>
                        </div>
                    </table>
                    <!--div style="background:#f8f8f8; -moz-border-radius:0.4em; -webkit-border-radius:0.4em; margin-bottom:5px; padding:1px;"
                         tal:repeat="user users2">
                        <tal:defineAgain define="userName python:user[0];
                                                 userObjects python:user[1];
                                                 userImage python:user[2];
                                                 info python:membership.getMemberInfo(userName);
                                                 fullname info/fullname;
                                                 location info/location;">
                            <img src="#" tal:attributes="src userImage" width="30" style="margin:15px 11px; float:left;" />
                            <h4 tal:define="url python:'/'.join(here.getPhysicalPath()) + '/author/'+userName;">
                                <a tal:condition="python:len(fullname) != 0" href="#" tal:attributes="href url"><tal:block replace="fullname"/></a>
                                <a tal:condition="python:len(fullname) == 0" href="#" tal:attributes="href url"><tal:block replace="userName"/></a>
                            </h4>
                            <p>
                                <span tal:condition="location"><b>Location:</b> <tal:contentThis replace="location" /></span>
                            </p>
                        </tal:defineAgain>
                        <div style="clear:both;"></div>
                    </div-->
                </div>
            </div>
            <div style="margin:10px 0 0 20px; width:44%; float:left" tal:define="users view/activemembers3;
                                                                                 membership context/portal_membership;">
                <div style="background:#f8f8f8; -moz-border-radius:0.4em; -webkit-border-radius:0.4em; margin-bottom:5px; padding:3px 6px;">
                    <h2>Most active members</h2>
                    <p>
                        The following members have contributed more than 20 content items:
                    </p>
                    <div style="background:#f8f8f8; -moz-border-radius:0.4em; -webkit-border-radius:0.4em; margin-bottom:5px; padding:1px;"
                         tal:repeat="user users">
                        <tal:defineAgain define="userName python:user[0];
                                                 userObjects python:user[1];
                                                 userImage python:user[2];
                                                 info python:membership.getMemberInfo(userName);
                                                 fullname info/fullname;
                                                 location info/location;
                                                 member python:here.getMemberById(userName);
                                                 position python:member.getProperty('position');
                                                 institution python:member.getProperty('institution');">
                            <img src="#" tal:attributes="src userImage" width="30" style="margin:0px 11px; float:left;" />
                            <div style="width: 37px; background-color:white; float:left; -moz-border-radius:0.4em; -webkit-border-radius:0.4em; margin-bottom:5px; padding:5px; margin:3px 7px 0 0; font-size:20px; font-style:bold;">
                                <tal:jes content="userObjects"></tal:jes>
                            </div>
                            <span style="font-weight:bold; color:#581A74;" tal:define="url python:'/'.join(here.getPhysicalPath()) + '/author/'+userName;">
                                <a tal:condition="python:len(fullname) != 0" href="#" tal:attributes="href url"><tal:block replace="fullname"/></a>
                                <a tal:condition="python:len(fullname) == 0" href="#" tal:attributes="href url"><tal:block replace="userName"/></a>
                            </span>
                            <span tal:condition="python:location or institution">
                                <span tal:condition="location"><tal:contentThis replace="institution" /></span>,
                                <span tal:condition="location"><tal:contentThis replace="location" /></span>
                            </span>
                            <br />
                            <span style="font-style:italic; color:grey; font-size:11px;" tal:condition="position"><tal:contentThis replace="position" /></span>
                        </tal:defineAgain>
                        <div style="clear:both;"></div>
                    </div>
                </div>
            </div>
            <div style="margin:10px 0 0 20px; width:44%; float:left" tal:define="allcontent view/allContentItems;
                                                                                 alltotal view/allTotal;
                                                                                 allcontentbyarea view/allContentByArea;">
                <div style="background:#f8f8f8; -moz-border-radius:0.4em; -webkit-border-radius:0.4em; margin-bottom:5px; padding:3px 6px;">
                    <h2>Site statistics</h2>
                    <div>
                        All content items:
                        <span style="width: 37px; background-color:white; -moz-border-radius:0.4em; -webkit-border-radius:0.4em; margin-bottom:5px; padding:5px; margin:3px 7px 0 0; font-size:20px; font-style:bold;">
                            <span tal:content="alltotal" />
                        </span>

                        <script type="text/javascript">
                        $(document).ready(function(){
                            $('#showlink').next('div').hide();
                            $('#showlink2').next('div').hide();
                            $("#showlink").click(function(){
                                $("div#allcontent").slideToggle();
                                return false;
                            });
                            $("#showlink2").click(function(){
                                $("div#allcontent2").slideToggle();
                                return false;
                            });
                        });
                        </script>

                        <div style="clear:both;"></div>
                        <div style="margin:10px;">
                            <a href="#" id="showlink">Show by type »</a>
                            <div id="allcontent">
                                <table style="margin:10px 5px 5px 10px;">
                                    <tal:block repeat="n allcontent">
                                        <tr>
                                            <td style="border-right:20px solid transparent;"><tal:doctype content="n" />:</td>
                                            <td><span tal:content="python:allcontent[n]"/></td>
                                        </tr>
                                    </tal:block>
                                </table>
                            </div>

                            <div style="clear:both;"></div>

                            <a href="#" id="showlink2">Show by section »</a>
                            <div id="allcontent2">
                                <table style="margin:10px 5px 5px 10px;">
                                    <tal:block repeat="n allcontentbyarea">
                                        <tr>
                                            <td style="border-right:20px solid transparent;"><tal:doctype content="n" />:</td>
                                            <td><span tal:content="python:allcontentbyarea[n]"/></td>
                                        </tr>
                                    </tal:block>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div style="margin:10px 0 0 20px; width:44%; float:left">
                <div style="background:#f8f8f8; -moz-border-radius:0.4em; -webkit-border-radius:0.4em; margin-bottom:5px; padding:3px 6px;">
                    <h2>Becoming a member</h2>
                    <p>
                        Are you working with sweetpotato and would like to contribute to creating information on sweetpotato?
                    </p>
                    <p>
                        If yes, this website is for you.
                    <p>
                        Sweetpotato Knowledge Portal is open to anyone: <a href="login">first register here</a>,
                        and once your profile will be verified, you will be given permissions to start
                        creating content directly to this portal.
                    </p>
                    <p>
                        Or if you want to learn more about sweetpotato and this portal, <a href="../about">click here</a>.
                    </p>
                </div>
            </div>
        </metal:main>
    </metal:main_macro>
</html>
